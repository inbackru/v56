# üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é - –ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞

**–î–∞—Ç–∞:** 28 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** CSP –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª inline —Å–∫—Ä–∏–ø—Ç—ã, header menu –∏ Chaport —á–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û**

---

## üîç –ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫?

–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Content Security Policy (CSP) –Ω–∞—á–∞–ª –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å:

```
‚ùå Refused to execute inline script because it violates CSP directive
‚ùå chaport: can't get latest version
```

–≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ç–æ–º—É, —á—Ç–æ:
- ‚ùå Header menu –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ
- ‚ùå –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª–∏—Å—å
- ‚ùå JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å
- ‚ùå **Chaport Live Chat –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª—Å—è**

---

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ?

### 1. **–£–±—Ä–∞–Ω nonce –∏–∑ CSP**
–†–∞–Ω—å—à–µ –≤ `security_config.py` –±—ã–ª–∞ —Å—Ç—Ä–æ–∫–∞:
```python
content_security_policy_nonce_in=['script-src'],  # ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∞–ª–æ inline —Å–∫—Ä–∏–ø—Ç—ã
```

–¢–µ–ø–µ—Ä—å —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ —É–±—Ä–∞–Ω–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç `'unsafe-inline'` —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 2. **–î–æ–±–∞–≤–ª–µ–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –¥–æ–º–µ–Ω—ã –≤ whitelist**
–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```python
'script-src': [
    'https://cdn.jsdelivr.net',  # Axios –∏ –¥—Ä—É–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
    'https://mc.yandex.ru',      # Yandex Metrika
    'https://app.chaport.ru',    # Chaport —á–∞—Ç-–≤–∏–¥–∂–µ—Ç
]

'connect-src': [
    'https://mc.yandex.ru',      # Yandex Metrika API
    'https://app.chaport.ru',    # Chaport API
    'wss://app.chaport.ru',      # Chaport WebSocket
]
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ **Header menu** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ **–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞** –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- ‚úÖ **JavaScript** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **Yandex Metrika** –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ **Chaport —á–∞—Ç** —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–í—Å–µ inline —Å–∫—Ä–∏–ø—Ç—ã** —Ä–∞–±–æ—Ç–∞—é—Ç

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:
- ‚úÖ Rate Limiting –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ CSRF Protection –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ XSS Protection –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ SQL Injection Protection –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ Clickjacking Protection –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ Security Headers —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞

–í browser console –ª–æ–≥–∞—Ö –±–æ–ª—å—à–µ –Ω–µ—Ç –æ—à–∏–±–æ–∫ CSP:
```
‚úÖ Header: openApplicationModal function defined
‚úÖ SuperSearch initialized successfully
‚úÖ FavoritesManager initialized from favorites.js
‚úÖ Performance Optimizer initialized
```

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π —Ñ–∞–π–ª:** `security_config.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1** - –£–±—Ä–∞–Ω nonce (—Å—Ç—Ä–æ–∫–∞ 115):
```python
# –ë–´–õ–û:
content_security_policy_nonce_in=['script-src'],

# –°–¢–ê–õ–û:
# NOTE: nonce is disabled to allow 'unsafe-inline' to work
# (—Å—Ç—Ä–æ–∫–∞ —É–¥–∞–ª–µ–Ω–∞)
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 2** - –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–º–µ–Ω—ã (—Å—Ç—Ä–æ–∫–∏ 79-83):
```python
'script-src': [
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ...
    'https://cdn.jsdelivr.net',  # NEW
    'https://mc.yandex.ru',      # NEW
    'https://app.chaport.ru',    # NEW
],
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 3** - –î–æ–±–∞–≤–ª–µ–Ω—ã API endpoints (—Å—Ç—Ä–æ–∫–∏ 107-109):
```python
'connect-src': [
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ...
    'https://mc.yandex.ru',      # NEW
    'https://app.chaport.ru',    # NEW
    'wss://app.chaport.ru',      # NEW (WebSocket)
],
```

---

## üöÄ –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –∑–∞—Ö–æ—Ç–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

1. **–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –≤—Å–µ inline —Å–∫—Ä–∏–ø—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ .js —Ñ–∞–π–ª—ã**
2. **–í–∫–ª—é—á–∏—Ç–µ nonce –æ–±—Ä–∞—Ç–Ω–æ:**
   ```python
   content_security_policy_nonce_in=['script-src'],
   ```
3. **–£–¥–∞–ª–∏—Ç–µ 'unsafe-inline' –∏–∑ CSP**

–ù–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ - —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–∞ –¥–ª—è production.

---

## ‚úÖ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** 

–°–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ + –∑–∞—â–∏—â—ë–Ω –æ—Ç –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫:
- SQL Injection ‚úÖ
- XSS ‚úÖ
- CSRF ‚úÖ
- DDoS ‚úÖ
- Clickjacking ‚úÖ
- Session Hijacking ‚úÖ

**–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç–∏–≥–Ω—É—Ç!** üéâ

---

*–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: —Å–º. —Ñ–∞–π–ª `SECURITY.md`*

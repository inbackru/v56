{% extends "admin/base.html" %}

{% block title %}Редактировать категорию - Админ панель | InBack{% endblock %}
{% block page_title %}Редактировать категорию вакансий{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-6">
    <!-- Page Header -->
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold text-gray-900">Редактировать категорию вакансий</h1>
            <p class="text-gray-600 mt-2">Изменение существующей категории для организации вакансий</p>
        </div>
        <a href="{{ url_for('admin_job_categories_management') }}" 
           class="text-gray-600 hover:text-gray-800 font-medium">
            <i class="fas fa-arrow-left mr-2"></i>Назад к списку
        </a>
    </div>

    <!-- Form -->
    <div class="bg-white rounded-lg shadow p-6">
        <form method="POST" class="space-y-6">
            <!-- Category Name -->
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                    Название категории *
                </label>
                <input type="text" 
                       id="name" 
                       name="name" 
                       value="{{ category.name }}"
                       required
                       placeholder="Например: IT и разработка"
                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1e40af] focus:border-transparent">
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Описание
                </label>
                <textarea id="description" 
                          name="description" 
                          rows="3"
                          placeholder="Краткое описание категории..."
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1e40af] focus:border-transparent">{{ category.description or '' }}</textarea>
            </div>

            <!-- Icon -->
            <div>
                <label for="icon" class="block text-sm font-medium text-gray-700 mb-2">
                    Иконка *
                </label>
                <div class="grid grid-cols-6 gap-3 mb-3">
                    <div class="col-span-6 sm:col-span-3">
                        <input type="text" 
                               id="icon" 
                               name="icon" 
                               value="{{ category.icon }}"
                               required
                               placeholder="fas fa-laptop-code"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1e40af] focus:border-transparent">
                    </div>
                    <div class="col-span-6 sm:col-span-3">
                        <div class="w-full h-10 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-50">
                            <i id="iconPreview" class="{{ category.icon }} text-lg" style="color: {{ category.color }};"></i>
                        </div>
                    </div>
                </div>
                <div class="text-xs text-gray-500">
                    Популярные иконки: 
                    <button type="button" onclick="setIcon('fas fa-laptop-code')" class="text-blue-600 hover:underline">fa-laptop-code</button>, 
                    <button type="button" onclick="setIcon('fas fa-chart-line')" class="text-blue-600 hover:underline">fa-chart-line</button>, 
                    <button type="button" onclick="setIcon('fas fa-briefcase')" class="text-blue-600 hover:underline">fa-briefcase</button>,
                    <button type="button" onclick="setIcon('fas fa-gavel')" class="text-blue-600 hover:underline">fa-gavel</button>
                </div>
            </div>

            <!-- Color -->
            <div>
                <label for="color" class="block text-sm font-medium text-gray-700 mb-2">
                    Цвет *
                </label>
                <div class="flex items-center space-x-4">
                    <input type="color" 
                           id="color" 
                           name="color" 
                           value="{{ category.color }}"
                           required
                           class="h-10 w-16 rounded border border-gray-300">
                    <input type="text" 
                           id="colorText" 
                           name="colorText" 
                           value="{{ category.color }}"
                           placeholder="#1e40af"
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1e40af] focus:border-transparent">
                </div>
                <div class="mt-2 flex space-x-2">
                    <button type="button" onclick="setColor('#1e40af')" class="w-6 h-6 rounded-full bg-blue-600 border-2 border-gray-300"></button>
                    <button type="button" onclick="setColor('#059669')" class="w-6 h-6 rounded-full bg-green-600 border-2 border-gray-300"></button>
                    <button type="button" onclick="setColor('#dc2626')" class="w-6 h-6 rounded-full bg-red-600 border-2 border-gray-300"></button>
                    <button type="button" onclick="setColor('#7c3aed')" class="w-6 h-6 rounded-full bg-purple-600 border-2 border-gray-300"></button>
                    <button type="button" onclick="setColor('#ea580c')" class="w-6 h-6 rounded-full bg-orange-600 border-2 border-gray-300"></button>
                </div>
            </div>

            <!-- Sort Order -->
            <div>
                <label for="sort_order" class="block text-sm font-medium text-gray-700 mb-2">
                    Порядок сортировки
                </label>
                <input type="number" 
                       id="sort_order" 
                       name="sort_order" 
                       value="{{ category.sort_order or 1 }}"
                       min="1"
                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1e40af] focus:border-transparent">
                <p class="text-xs text-gray-500 mt-1">Чем меньше число, тем выше в списке</p>
            </div>

            <!-- Active Status -->
            <div class="flex items-center">
                <input type="checkbox" 
                       id="is_active" 
                       name="is_active" 
                       {% if category.is_active %}checked{% endif %}
                       class="h-4 w-4 text-[#1e40af] border-gray-300 rounded focus:ring-[#1e40af]">
                <label for="is_active" class="ml-2 block text-sm text-gray-700">
                    Активная категория
                </label>
            </div>

            <!-- Submit Buttons -->
            <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
                <a href="{{ url_for('admin_job_categories_management') }}" 
                   class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors">
                    Отмена
                </a>
                <button type="submit" 
                        class="px-6 py-2 bg-[#1e40af] hover:bg-[#1d4ed8] text-white rounded-lg font-medium transition-colors">
                    Сохранить изменения
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Icon preview
document.getElementById('icon').addEventListener('input', function() {
    const iconValue = this.value;
    const preview = document.getElementById('iconPreview');
    if (iconValue) {
        preview.className = iconValue + ' text-lg';
        preview.style.color = document.getElementById('color').value;
    } else {
        preview.className = 'fas fa-question text-gray-400 text-lg';
    }
});

// Color sync
document.getElementById('color').addEventListener('input', function() {
    document.getElementById('colorText').value = this.value;
    const preview = document.getElementById('iconPreview');
    preview.style.color = this.value;
});

document.getElementById('colorText').addEventListener('input', function() {
    const colorValue = this.value;
    if (/^#[0-9A-Fa-f]{6}$/.test(colorValue)) {
        document.getElementById('color').value = colorValue;
        const preview = document.getElementById('iconPreview');
        preview.style.color = colorValue;
    }
});

// Helper functions
function setIcon(iconClass) {
    document.getElementById('icon').value = iconClass;
    document.getElementById('icon').dispatchEvent(new Event('input'));
}

function setColor(colorValue) {
    document.getElementById('color').value = colorValue;
    document.getElementById('colorText').value = colorValue;
    const preview = document.getElementById('iconPreview');
    preview.style.color = colorValue;
}

// Initial preview
document.getElementById('icon').dispatchEvent(new Event('input'));
</script>
{% endblock %}